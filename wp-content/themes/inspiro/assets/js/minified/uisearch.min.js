!function(e){"use strict";function t(e,t){Window.prototype[e]=HTMLDocument.prototype[e]=Element.prototype[e]=t}var i;function n(e,t){this.el=e,this.inputEl=e.querySelector("form input.sb-search-input"),this._initEvents()}!e.addEventListener&&e.Element&&(i=[],t("addEventListener",function(e,t){var n=this;i.unshift({__listener:function(e){e.currentTarget=n,e.pageX=e.clientX+document.documentElement.scrollLeft,e.pageY=e.clientY+document.documentElement.scrollTop,e.preventDefault=function(){e.returnValue=!1},e.relatedTarget=e.fromElement||null,e.stopPropagation=function(){e.cancelBubble=!0},e.relatedTarget=e.fromElement||null,e.target=e.srcElement||n,e.timeStamp=+new Date,t.call(n,e)},listener:t,target:n,type:e}),this.attachEvent("on"+e,i[0].__listener)}),t("removeEventListener",function(e,t){for(var n=0,s=i.length;n<s;++n)if(i[n].target==this&&i[n].type==e&&i[n].listener==t)return this.detachEvent("on"+e,i.splice(n,1)[0].__listener)}),t("dispatchEvent",function(t){try{return this.fireEvent("on"+t.type,t)}catch(e){for(var n=0,s=i.length;n<s;++n)i[n].target==this&&i[n].type==t.type&&i[n].call(this,t)}})),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),n.prototype={_initEvents:function(){function e(e){e.stopPropagation(),t.inputEl.value=t.inputEl.value.trim(),classie.has(t.el,"sb-search-open")?(classie.has(t.el,"sb-search-open")&&/^\s*$/.test(t.inputEl.value)||classie.has(t.el,"sb-search-open")&&(classie.has(e.target,"sb-icon-search")||"use"===e.target.nodeName))&&(e.preventDefault(),t.close()):(e.preventDefault(),t.open())}var t=this;this.el.addEventListener("click",e),this.el.addEventListener("touchstart",e),this.inputEl.addEventListener("click",function(e){e.stopPropagation()}),this.inputEl.addEventListener("touchstart",function(e){e.stopPropagation()})},open:function(){var t=this;classie.add(this.el,"sb-search-open"),this.inputEl.focus();var n=function(e){(classie.has(t.el,"sb-search-open")&&/^\s*$/.test(t.inputEl.value)||classie.has(t.el,"sb-search-open")&&(classie.has(e.target,"sb-icon-search")||"use"===e.target.nodeName))&&(e.preventDefault(),t.close()),this.removeEventListener("click",n),this.removeEventListener("touchstart",n)};document.addEventListener("click",n),document.addEventListener("touchstart",n)},close:function(){this.inputEl.blur(),classie.remove(this.el,"sb-search-open"),this.el.querySelector(".sb-search-button-open").focus()}},e.UISearch=n}(window);